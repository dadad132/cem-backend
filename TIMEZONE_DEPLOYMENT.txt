# Timezone Feature - Deployment Instructions

## What Was Added

The workspace timezone feature allows you to set a default timezone for your workspace in Site Settings. This ensures all times are displayed consistently across all pages.

## Deployment Steps

### 1. Update Code on Server

Use your website's update button or run manually:
```bash
git pull origin main
```

### 2. Run Database Migration

**IMPORTANT**: You must run this migration after updating the code:

```bash
python migrations/add_workspace_timezone.py
```

Expected output:
```
============================================================
Migration: Add timezone to workspace table
============================================================
üìù Adding timezone column to workspace table...
‚úÖ Successfully added timezone column to workspace table
‚ÑπÔ∏è  Default timezone set to UTC for all existing workspaces
```

### 3. Restart Server

Restart your application server to load the new code.

### 4. Configure Timezone

1. Log in as admin
2. Go to **Admin** ‚Üí **Site Settings**
3. Find the **Timezone** dropdown (new field)
4. Select your timezone (e.g., "Africa/Johannesburg (SAST)")
5. Click **Save Settings**

## How It Works

- All datetimes are stored in UTC in the database (unchanged)
- When displaying times, they are converted to your workspace timezone
- This fixes the issue where "some tabs have different times than the others"

## Template Updates Needed

To apply timezone conversion to existing templates, use the new filter:

**Before:**
```html
{{ ticket.created_at.strftime('%b %d, %Y %I:%M %p') }}
```

**After:**
```html
{{ ticket.created_at | format_datetime_tz(workspace.timezone, '%b %d, %Y %I:%M %p') }}
```

## Available Timezones

- UTC (Default)
- Africa/Johannesburg (SAST)
- America/New_York (EST/EDT)
- America/Chicago (CST/CDT)
- America/Denver (MST/MDT)
- America/Los_Angeles (PST/PDT)
- Europe/London (GMT/BST)
- Europe/Paris (CET/CEST)
- Asia/Dubai (GST)
- Asia/Kolkata (IST)
- Asia/Shanghai (CST)
- Asia/Tokyo (JST)
- Australia/Sydney (AEDT/AEST)

## Troubleshooting

**Error: "no such column: workspace.timezone"**
- Solution: Run the migration script: `python migrations/add_workspace_timezone.py`

**Times still showing in UTC**
- Check if timezone is set in Site Settings
- Restart server after changing timezone
- Verify templates are using the new filter (optional for now)

## Next Steps

After deployment, gradually update templates to use the timezone filter for consistent time display across all pages.

See `docs/WORKSPACE_TIMEZONE.md` for detailed documentation.
